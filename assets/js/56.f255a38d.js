(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{268:function(t,e,a){"use strict";a.r(e);var r=a(28),n=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"数据格式化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据格式化"}},[t._v("#")]),t._v(" 数据格式化")]),t._v(" "),a("div",{staticClass:"lake-content-editor-core lake-engine",attrs:{"data-lake-element":"root","data-selection-124615":"%7B%22path%22%3A%5B%5B18%2C0%2C1%2C0%2C3%2C0%2C0%2C0%5D%2C%5B18%2C0%2C1%2C0%2C3%2C0%2C0%2C0%5D%5D%2C%22uuid%22%3A%22124615%22%2C%22active%22%3Atrue%7D"}},[a("h2",{attrs:{id:"json数据格式化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json数据格式化"}},[t._v("#")]),t._v(" JSON数据格式化")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"LZEtl"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const todayILearn = {\n _id: 1,\n content: '今天学习 JSON.stringify()，我很开心！',\n created_at: 'Mon Nov 25 2019 14:03:55 GMT+0800 (中国标准时间)',\n updated_at: 'Mon Nov 25 2019 16:03:55 GMT+0800 (中国标准时间)'\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v("将上面这个对象处理成下面这个对象")])]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"Vr9TY"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const todayILearn = {\n id: 1,\n content: '今天学习 JSON.stringify()，我很开心！',\n createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (中国标准时间)',\n updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (中国标准时间)'\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v("也就是在不改变属性的值的前提下，将对象属性修改一下。 把")]),a("code",[t._v("_id")]),a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v(" 改成 ")]),a("code",[t._v("id")]),a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v("，把 ")]),a("code",[t._v("updated_at")]),a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v(" 改成 ")]),a("code",[t._v("updatedAt")]),a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v("，把 ")]),a("code",[t._v("created_at")]),a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v(" 改成 ")]),a("code",[t._v("createdAt")]),a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[t._v("。")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{staticClass:"lake-fontsize-11",staticStyle:{color:"rgb(51, 51, 51)","font-size":"14px","line-height":"24px"},attrs:{"data-mce-style":"font-size: 11px"}},[a("br")])]),t._v(" "),a("h4",{attrs:{id:"方案：序列化-replace-美学典范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案：序列化-replace-美学典范"}},[t._v("#")]),t._v(" 方案：序列化+ replace 美学典范")]),t._v(" "),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"qQoia"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const mapObj = {\n _id: \"id\",\n created_at: \"createdAt\",\n updated_at: \"updatedAt\"\n};\nJSON.parse(\n JSON.stringify(todayILearn).replace(\n   /_id|created_at|updated_at/gi,\n   matched => mapObj[matched]\n )\n)\n\n// { \n// id: 1,\n//  content: '今天学习 JSON.stringify()，我很开心！',\n//  createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (中国标准时间)',\n//  updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (中国标准时间)' \n// } \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h2",{attrs:{id:"接口数据格式化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#接口数据格式化"}},[t._v("#")]),t._v(" 接口数据格式化")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h4",{attrs:{id:"约定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#约定"}},[t._v("#")]),t._v(" 约定")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("要明确所有的接口格式都要如下返回：")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"joN10"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{\n   status: 200,\n   code: 10000,\n message: '',\n data: {\n   ...\n },\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h4",{attrs:{id:"处理数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#处理数据"}},[t._v("#")]),t._v(" 处理数据")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("credit.js")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"l1aiB"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import dayjs from 'dayjs'\nimport { apiRequest as Axios, courseRequest } from '@@/utils/axios'\nimport { injectRowKey } from '@@/utils/rowKey'\nimport { getCreateTime } from '@@/utils/format'\nimport { decodeUniqueId } from '@@/utils/crypto'\n\nconst decodeName = code => {\n switch (code) {\n   case 'finance_quotient_course_study_add_200':\n     return '学习课程'\n   case 'finance_quotient_course_notes_add_200':\n     return '写笔记'\n   case 'finance_quotient_course_praxis_add_200':\n     return '做测试题'\n   case 'finance_quotient_transfer_1_ratio':\n     return '历史积分导入'\n   case 'finance_quotient_course_note_share_add_400':\n     return '分享笔记'\n   case 'finance_quotient_exchange_subtract_1_ratio':\n     return '积分兑换'\n }\n}\n\nconst creditFormat = item => {\n return {\n   name: decodeName(item.creditRuleCode),\n   createdAt: item.createdAt || new Date().valueOf(),\n   createdTime: getCreateTime(item.createdAt * 1000),\n   action: item.action,\n   amount: item.amount,\n   tradeNumber: item.tradeNumber,\n   isValid: item.isValid === 1, // 0-无效，1-有效\n }\n}\n\nclass CreditService {\n   async list(pageNum = 1, pageSize = 10) {\n   const {\n     data: { items = [], total },\n   } = await Axios.get('/user-center/credit/transactions', {\n     params: {\n       pageNum,\n       pageSize,\n       creditTypeCode: 'fq_credit',\n     },\n   })\n   const list = items.map(creditFormat)\n\n   return { items: injectRowKey(list), total: total || items.length }\n }\n}\nexport default new CreditService() \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h4",{attrs:{id:"调用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调用"}},[t._v("#")]),t._v(" 调用")]),t._v(" "),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"wrA55"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import creditService from '@@/services/credit'\n\n\naction = {\n handleFetch: async () => {\n   const { items, total } = await creditService.list(current.pageNum, pageSize)\n   this.setState({\n     ...\n   })\n },\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h4",{attrs:{id:"依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖"}},[t._v("#")]),t._v(" 依赖")]),t._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("rowKey.js")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"F6twA"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import UUID from 'uuid'\n\n// 设置数据唯一标识\nexport const setRowKey = data => {\n return Object.assign({ rowKey: UUID() }, data)\n}\n\n// 数组遍历设置唯一标识\nexport const injectRowKey = dataSource => {\n return Array.isArray(dataSource) ? dataSource.map(setRowKey) : []\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("format.js")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"nEFLg"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import dayjs from 'dayjs'\n\nconst currentYear = new Date().getFullYear()\nconst startDay = new Date(new Date().toLocaleDateString()).valueOf()\nconst endDay = startDay + 24 * 60 * 60 * 1000\n\nconst timeFormatList = [\n {\n   check: time => time >= startDay && time < endDay,\n   render: time => '今天 ' + dayjs(time).format('HH:mm'),\n },\n {\n   check: time => dayjs(time).year() === currentYear,\n   render: time => dayjs(time).format('MM-DD HH:mm'),\n },\n {\n   check: () => true,\n   render: time => dayjs(time).format('YYYY-MM-DD HH:mm'),\n },\n]\n\nexport const getCreateTime = createdAt => {\n const format = timeFormatList.find(item => {\n   if (item.check(createdAt)) {\n     return item\n   }\n })\n return format.render(createdAt)\n}\n\nexport const timeFormat = time => {\n const thisYear = dayjs(time).year()\n if (thisYear === currentYear) {\n   return dayjs(time).format('M月DD日')\n } else {\n   return dayjs(time).format('YYYY年M月DD日')\n }\n}\n\nconst checkList = [\n {\n   check: value => value >= 1000 * 10000,\n   format: value => '999万+',\n },\n {\n   check: value => value >= 10000,\n   format: value => {\n     const result = Math.round(+value / 10000)\n     if (result === 1000) {\n       return '999万+'\n     }\n     return `${result}万`\n   },\n },\n {\n   check: value => value >= 0,\n   format: value => value,\n },\n]\n\n// 数字格式化\nexport const numberFormat = number => {\n const checker = checkList.find(item => item.check(number))\n return checker.format(number)\n}\n\n// 商品价格格式化\nexport const priceFormat = (price = 0, precison = 2) => {\n price = Number(price) || 0\n return +price.toFixed(precison)\n}\n\n// 收益率格式化\nexport const profitRateFormat = (profitRate = 0) => {\n return (profitRate * 100).toFixed(2) + '%'\n}\n\n// 有符号收益率格式化\nexport const signedProfitRateFormat = (profitRate = 0) => {\n if (profitRate > 0) {\n   return `+${(profitRate * 100).toFixed(2)}%`\n } else {\n   return `${(profitRate * 100).toFixed(2)}%`\n }\n}\n\n// 百分比格式化\nexport const percentageFormat = (number = 0) => {\n return Math.round(number * 100) + '%'\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[t._v("crypto.js")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"IrLpi"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(38, 38, 38)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 课程资源自定义编号拼接\nexport const encodeUniqueId = (productId, chapterId, resourceId) => {\n return [productId, chapterId, resourceId].join('-')\n}\n\n// 课程资源自定义编号解析\nexport const decodeUniqueId = uniqueId => {\n const [productId, chapterId, resourceId] = uniqueId.split('-')\n return [productId, chapterId, resourceId].map(item => parseInt(item, 10))\n}\n\n// 课程资源自定义编号解析\nexport const parseUniqueId = uniqueId => {\n const [productId, chapterId, resourceId] = uniqueId.split('-').map(item => parseInt(item, 10))\n return { productId, chapterId, resourceId }\n}\n\n// 原生交互数据编码\nexport const encodeHybrid = data => {\n const payload = Object.assign({}, data)\n return btoa(encodeURIComponent(JSON.stringify(payload)))\n}\n\n// 原生交互数据解码\nexport const decodeHybrid = str => {\n try {\n   return JSON.parse(decodeURIComponent(atob(str)))\n } catch (error) {\n   console.warn(error)\n   return {}\n }\n} \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ol",{staticStyle:{"list-style-type":"decimal",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"24px","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{start:"1","lake-indent":"0"}},[a("li",[a("a",{attrs:{href:"https://juejin.im/post/5decf09de51d45584d238319?utm_source=gold_browser_extension",target:"_blank"}},[t._v("你不知道的 JSON.stringify() 的威力")])])])])])}),[],!1,null,null,null);e.default=n.exports}}]);