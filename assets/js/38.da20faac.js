(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{275:function(e,t,a){"use strict";a.r(t);var o=a(28),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"多次异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多次异步"}},[e._v("#")]),e._v(" 多次异步")]),e._v(" "),a("div",{staticClass:"lake-content-editor-core lake-engine lake-typography-traditional",attrs:{"data-lake-element":"root"}},[a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"},attrs:{"data-lake-id":"d9c09d575d0787b3e82d66950f7f8fb9"}},[e._v("应用场景，在购买前，查询是否有购买权限。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"},attrs:{"data-lake-id":"81b43ce189a23125c3752c3231ccd891"}},[a("br")]),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"YCmSa"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(89, 89, 89)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\nconst handleGoodBuy = async ({ goodsSn, goodsBizNos, skuSn }) => {\n Toast.loading();\n\n try {\n   const isSingle = goodsBizNos.length === 1;\n   const responses = await Promise.all(goodsBizNos.map(goodsBizNo => courseService.checkPurchased(goodsBizNo)));\n   const current = responses.find(response => Object.keys(response).length > 0);\n   Toast.hide();\n   if (current) {\n     PreventPurchaseBox.show({ courseName: current.title, isSingle });\n     return false;\n   }\n   window.location.href = `/finance/course/cashier?goodsSn=${goodsSn}&skuSn=${skuSn}&flowId=${flowId}`;\n } catch (error) {\n   Toast.show(error.message);\n }\n return true;\n}; \n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"},attrs:{"data-lake-id":"d0a008df5ce0c86961a094d1c4429c02"}},[a("br")]),a("ol",{staticStyle:{"list-style-type":"decimal",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"data-lake-id":"8d3e48d81680a3efdf2c42c9516f29d3",start:"1","lake-indent":"0"}},[a("li",{attrs:{"data-lake-id":"5a1bc38628034245d09bb9d221e3d7f3"}},[e._v("将需要查询的对象goodsBizNos遍历，创建请求队列")]),a("li",{attrs:{"data-lake-id":"123abd9124f69581080646fa1edcd11a"}},[e._v("Promise.all，请求队列")]),a("li",{attrs:{"data-lake-id":"3c8a28e6e72568b7e54f34586be422bf"}},[e._v("在返回的responses（数组）中查找是否有异常数据，此时用find")]),a("li",{attrs:{"data-lake-id":"8415cf40d5b8993ba5dba8cdd3b874ff"}},[e._v("处理第一个异常数据current")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"},attrs:{"data-lake-id":"aa056acb824e5ef198b7d088e227876d"}},[a("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);