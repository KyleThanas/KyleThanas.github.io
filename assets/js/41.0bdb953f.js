(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{234:function(e,t,r){"use strict";r.r(t);var n=r(28),a=Object(n.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"视频播放-自动播放"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#视频播放-自动播放"}},[e._v("#")]),e._v(" 视频播放--自动播放")]),e._v(" "),r("div",{staticClass:"lake-engine lake-typography-traditional",attrs:{"data-lake-element":"root","data-parser-by":"lake2html"}},[r("h4",{attrs:{id:"关于自动播放"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#关于自动播放"}},[e._v("#")]),e._v(" 关于自动播放")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("blockquote",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","padding-left":"1em","margin-left":"0px","border-left":"3px solid rgb(238, 238, 238)",opacity:"0.6"}},[r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("autoPlay 布尔属性；指定后，视频会马上自动开始播放，不会停下来等着数据载入结束。")])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h6",{attrs:{id:"ios"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#ios"}},[e._v("#")]),e._v(" IOS")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("无音频源的 video 元素 允许自动播放")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("禁音的 video 元素允许自动播放")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("如果 video 元素在没有用户手势下有了音频源或者变成非禁音，会暂停播放")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("video 元素屏幕可见才开始播放")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("video元素不可见后停止播放")])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h6",{attrs:{id:"android"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#android"}},[e._v("#")]),e._v(" Android")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("strong",[e._v("安卓的")]),e._v(" "),r("strong",[e._v("chrome 53 后")]),e._v("放宽了自动播放策略，策略不同于IOS的Safari，需要同时对 video 设置 "),r("code",[e._v("autoplay")]),e._v(" 和 "),r("code",[e._v("muted")]),e._v("（是否禁音），才允许自动播放； "),r("code",[e._v("安卓的 FireFox 和 UC 浏览器")]),e._v("支持任何情况下的自动播放； 安卓的其他浏览器暂时不清楚情况；")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h6",{attrs:{id:"safari-浏览器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#safari-浏览器"}},[e._v("#")]),e._v(" Safari 浏览器")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("code",[e._v("Safari 10")]),e._v(" 后带音频的视频和音频默认禁止自动播放，更多信息可以参考"),r("a",{attrs:{href:"https://webkit.org/blog/7734/auto-play-policy-changes-for-macos/",target:"_blank",rel:"noopener noreferrer"}},[e._v("这篇文章")]),e._v("；")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h6",{attrs:{id:"chrome-浏览器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#chrome-浏览器"}},[e._v("#")]),e._v(" Chrome 浏览器")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("禁音的视频依旧可以播放，带声音的视频会根据媒体参与指数来决定能否自动播放，那什么是媒体参与指数？官方给了解释和相关的维度：")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("blockquote",{staticStyle:{"margin-top":"5px","margin-bottom":"5px","padding-left":"1em","margin-left":"0px","border-left":"3px solid rgb(238, 238, 238)",opacity:"0.6"}},[r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("MEI 是一个评估用户对于当前站点的媒体参与程度的指数，它取决于下面几个维度:")])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("用户在媒体上停留时间超过了")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("7秒以上音频必须是展示出来，并且没有静音与")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("video 之间有过交互")])]),r("ul",{staticStyle:{"list-style-type":"disc",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[r("li",[e._v("媒体的尺寸不小于 200x140.")])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h4",{attrs:{id:"检测能否自动播放？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#检测能否自动播放？"}},[e._v("#")]),e._v(" 检测能否自动播放？")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock","data-card-value":"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22var%20promise%20%3D%20document.querySelector('video').play()%3B%5Cn%5Cnif%20(promise%20!%3D%3D%20undefined)%20%7B%5Cn%20%20%20%20promise.catch(error%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%2F%2F%20Auto-play%20was%20prevented%5Cn%20%20%20%20%20%20%20%20%2F%2F%20Show%20a%20UI%20element%20to%20let%20the%20user%20manually%20start%20playback%5Cn%20%20%20%20%7D).then(()%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%2F%2F%20Auto-play%20started%5Cn%20%20%20%20%7D)%3B%5Cn%7D%22%2C%22id%22%3A%22FuJFb%22%7D",id:"FuJFb"}},[r("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(0, 0, 0)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[r("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[r("div",{staticClass:"language-undefined extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("var promise = document.querySelector('video').play();\n\nif (promise !== undefined) {\n   promise.catch(error => {\n       // Auto-play was prevented\n       // Show a UI element to let the user manually start playback\n   }).then(() => {\n       // Auto-play started\n   });\n} \n")])])])])])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h4",{attrs:{id:"为什么-ios-下微信和钉钉可以自动播放带声音的视频？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#为什么-ios-下微信和钉钉可以自动播放带声音的视频？"}},[e._v("#")]),e._v(" 为什么 IOS 下微信和钉钉可以自动播放带声音的视频？")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("确实发现在微信经常能看到自动播放的H5，但是作者自己写的设置了 autoplay、playsInline 的视频播放样例，在微信上依旧无法自动播放，而在钉钉上却可以自动播放")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("系统-浏览器带声音不带声音IOS 钉钉支持支持IOS Safari禁止自动播放IOS 微信禁止禁止")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("通过查询资料，IOS WebAPP 开发都是基于 IOS 提供的浏览器内核进行开发的，所以在 WebAPP 的 webview 中可以修改自动播放的表现，钉钉明显是支持自动播放，微信则是禁止自动播放，但是提供了内置事件来支持自动播放：")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("微信下通过 WeixinJSBridgeReady 事件进行自动播放：")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock","data-card-value":"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22document.addEventListener(%5Cn%20%20'WeixinJSBridgeReady'%2C%5Cn%20%20function()%20%7B%5Cn%20%20%20%20video.play()%3B%5Cn%20%20%7D%2C%5Cn%20%20false%5Cn)%3B%22%2C%22id%22%3A%22DOK6P%22%7D",id:"DOK6P"}},[r("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(0, 0, 0)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[r("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[r("div",{staticClass:"language-undefined extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("document.addEventListener(\n 'WeixinJSBridgeReady',\n function() {\n   video.play();\n },\n false\n); \n")])])])])])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("原文地址："),r("a",{attrs:{href:"http://link.zhihu.com/?target=https%3A//github.com/ProtoTeam/blog/blob/master/201806/1.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ProtoTeam/blog/blob/master/201806/1.md")])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),e._v(" "),r("h4",{attrs:{id:"追加内容"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#追加内容"}},[e._v("#")]),e._v(" 追加内容")]),e._v(" "),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[e._v("微信H5自动播放音频")]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")]),r("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock","data-card-value":"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22yinyue('Fireworks')%5Cn%20%20%20%20function%20yinyue(d)%20%7B%5Cn%20%20%20%20%20%20%20%20var%20b%20%3D%20document.getElementById(d)%3B%5Cn%20%20%20%20%20%20%20%20var%20c%20%3D%20function%20c()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20b.play()%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20document.removeEventListener(%5C%22touchstart%5C%22%2C%20c%2C%20false)%3B%5Cn%20%20%20%20%20%20%20%20%7D%3B%5Cn%20%20%20%20%20%20%20%20b.play()%3B%5Cn%20%20%20%20%20%20%20%20document.addEventListener(%5C%22WeixinJSBridgeReady%5C%22%2C%20function%20()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20c()%3B%5Cn%20%20%20%20%20%20%20%20%7D%2C%20false)%3B%5Cn%20%20%20%20%20%20%20%20document.addEventListener(%5C%22YixinJSBridgeReady%5C%22%2C%20function%20()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20c()%3B%5Cn%20%20%20%20%20%20%20%20%7D%2C%20false)%3B%5Cn%20%20%20%20%20%20%20%20document.addEventListener(%5C%22touchstart%5C%22%2C%20c%2C%20false)%3B%5Cn%20%20%20%20%7D%22%2C%22id%22%3A%22DiKxF%22%7D",id:"DiKxF"}},[r("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(0, 0, 0)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[r("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[r("div",{staticClass:"language-undefined extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('yinyue(\'Fireworks\')\n   function yinyue(d) {\n       var b = document.getElementById(d);\n       var c = function c() {\n           b.play();\n           document.removeEventListener("touchstart", c, false);\n       };\n       b.play();\n       document.addEventListener("WeixinJSBridgeReady", function () {\n           c();\n       }, false);\n       document.addEventListener("YixinJSBridgeReady", function () {\n           c();\n       }, false);\n       document.addEventListener("touchstart", c, false);\n   } \n')])])])])])]),r("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word","line-height":"1.74",margin:"0px"}},[r("br")])])])}),[],!1,null,null,null);t.default=a.exports}}]);