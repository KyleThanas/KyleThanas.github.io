(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{274:function(t,e,a){"use strict";a.r(e);var n=a(28),r=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"js轮询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js轮询"}},[t._v("#")]),t._v(" js轮询")]),t._v(" "),a("div",{staticClass:"lake-content-editor-core lake-engine lake-typography-traditional",attrs:{"data-lake-element":"root"}},[a("h2",{attrs:{id:"简版-await"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简版-await"}},[t._v("#")]),t._v(" 简版--await")]),t._v(" "),a("div",{staticClass:"lake-card-embed-toolbar-active lake-activated",attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"1knsk"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(89, 89, 89)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("export const sleep = (timeout = 100) => {\n return new Promise(resolve => {\n   setTimeout(resolve, timeout)\n })\n}\n\n// 轮询函数\nconst polling = async (request, times) => {\n if (times <= 0) {\n   return false;\n }\n\n const result = await request();\n if (result) {\n   return true;\n }\n\n await sleep(1000);\n return polling(request, times - 1);\n};\n\n// 请求主体函数\nconst checkOrder = async orderSn => {\n const {\n   data: { status },\n } = await Axios.get('/mall/order/status', {\n   params: { orderSn },\n })\n return status === 2\n}\n\n// 调用\n// 当请求主体函数返回true或者times跑完时候会终止\nconst status = await polling(() => checkOrder(appOrderSn), 3)\n\n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"},attrs:{"data-lake-id":"a20d224c568e48b9d67847a2c66a8c01_p_0"}},[a("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);