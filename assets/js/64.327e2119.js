(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{253:function(e,t,a){"use strict";a.r(t);var r=a(28),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"sendbeacon统计数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sendbeacon统计数据"}},[e._v("#")]),e._v(" sendBeacon统计数据")]),e._v(" "),a("div",{staticClass:"lake-content-editor-core lake-engine lake-typography-traditional",attrs:{"data-lake-element":"root"}},[a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("code",[e._v("navigator.sendBeacon()")]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 方法可用于通过")]),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP",target:"_blank"}},[e._v("HTTP")]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v("将少量数据异步传输到Web服务器。")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[e._v("刷新/关闭页面之前发送请求。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[a("br")])]),e._v(" "),a("h2",{attrs:{id:"开始"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始"}},[e._v("#")]),e._v(" 开始")]),e._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),e._v(" "),a("h4",{attrs:{id:"参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[e._v("#")]),e._v(" 参数")]),e._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[e._v("navigator.sendBeacon("),a("em",[e._v("url, ")]),a("em",[e._v("data")]),e._v(");")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[e._v("----"),a("code",[e._v("url")]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 参数表明 ")]),a("code",[e._v("data")]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 将要被发送到的网络地址。")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[e._v("----"),a("code",[e._v("data")]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 参数是将要发送的 ")]),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/ArrayBufferView",target:"_blank"}},[a("code",[e._v("ArrayBufferView")])]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 或 ")]),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Blob",target:"_blank"}},[a("code",[e._v("Blob")])]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(", ")]),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DOMString",target:"_blank"}},[a("code",[e._v("DOMString")])]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 或者 ")]),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/FormData",target:"_blank"}},[a("code",[e._v("FormData")])]),a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[e._v(" 类型的数据。")])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{staticClass:"lake-fontsize-12",staticStyle:{color:"rgb(51, 51, 51)","font-size":"16px"},attrs:{"data-mce-style":"font-size: 12px"}},[a("br")])]),e._v(" "),a("h4",{attrs:{id:"返回值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#返回值"}},[e._v("#")]),e._v(" 返回值")]),e._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[e._v("当用户代理成功把数据加入传输队列时，"),a("code",[e._v("sendBeacon()")]),e._v(" 方法将会返回 "),a("code",[e._v("true")]),e._v("，否则返回 "),a("code",[e._v("false")]),e._v("。")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),e._v(" "),a("h4",{attrs:{id:"代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[e._v("#")]),e._v(" 代码")]),e._v(" "),a("div",{attrs:{"data-card-type":"block","data-lake-card":"codeblock",id:"EsCvN"}},[a("div",{staticClass:"lake-codeblock-content",staticStyle:{border:"1px solid rgb(232, 232, 232)","max-width":"750px",color:"rgb(89, 89, 89)",margin:"0px",padding:"0px",background:"rgb(249, 249, 249)"}},[a("div",{staticStyle:{color:"rgb(89, 89, 89)",margin:"0px",padding:"16px",background:"none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)"}},[a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("const data = JSON.stringify({\n eventSn: eventId,\n sendingTime: Date.now(),\n token: this.people.token,\n eventVariable: eventLevelVariables,\n defaultVariable: {\n   ...this.global,\n   ...this.page(),\n   is_first_time,\n   ...{\n     open_id: this.people.open_id,\n     udid: this.people.udid,\n   },\n   title: document.title,\n },\n})\n\n\nif (navigator.sendBeacon && parser.os.name !== 'iOS') {\n window.navigator.sendBeacon(URL, data)\n} else {\n var client = new XMLHttpRequest()\n client.open('POST', URL, async)\n client.setRequestHeader('Content-Type', 'text/plain;charset=UTF-8')\n client.send(data)\n}\n\n")])])])])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),e._v(" "),a("h2",{attrs:{id:"支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#支持"}},[e._v("#")]),e._v(" 支持")]),e._v(" "),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"text-align":"center","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("span",{attrs:{"data-card-type":"inline","data-lake-card":"image"}},[a("img",{staticClass:"image lake-drag-image",staticStyle:{visibility:"visible",border:"none","box-shadow":"none",width:"746px",height:"343px"},attrs:{"data-role":"image",src:"https://cdn.nlark.com/yuque/0/2020/png/124615/1584012185680-5edd7410-645c-4cc0-8417-15459d318633.png","data-raw-src":"https://cdn.nlark.com/yuque/0/2020/png/124615/1584012185680-5edd7410-645c-4cc0-8417-15459d318633.png",alt:"image.png",title:"image.png"}})])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")]),e._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),a("ol",{staticStyle:{"list-style-type":"decimal",margin:"0px","padding-left":"23px","font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word"},attrs:{"lake-indent":"0"}},[a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon",target:"_blank"}},[e._v("Navigator.sendBeacon()-MDN")])]),a("li",[a("a",{attrs:{href:"https://code.xiaobangtouzi.com/fe/hunter/blob/master/src/main.js",target:"_blank"}},[e._v("Hunter埋点系统")])])]),a("p",{staticStyle:{"font-size":"14px",color:"rgb(38, 38, 38)","line-height":"1.74","letter-spacing":"0.05em","outline-style":"none","overflow-wrap":"break-word",margin:"0px"}},[a("br")])])])}),[],!1,null,null,null);t.default=o.exports}}]);