<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ­å»ºåŸºäº model çš„å¡ç‰‡åˆ—è¡¨é¡µé¢ | Ant Design 1111</title>
    <meta name="description" content="åŸºäº umi çš„ Ant Design 1111">
    
    
    <link rel="preload" href="/readbook/assets/css/0.styles.d6f0e1c6.css" as="style"><link rel="preload" href="/readbook/assets/js/app.205826b5.js" as="script"><link rel="preload" href="/readbook/assets/js/2.6adc2b3f.js" as="script"><link rel="preload" href="/readbook/assets/js/19.8e74b4bc.js" as="script"><link rel="prefetch" href="/readbook/assets/js/10.1636d440.js"><link rel="prefetch" href="/readbook/assets/js/11.70bf2f3a.js"><link rel="prefetch" href="/readbook/assets/js/12.a107a538.js"><link rel="prefetch" href="/readbook/assets/js/13.33cb767d.js"><link rel="prefetch" href="/readbook/assets/js/14.f9871772.js"><link rel="prefetch" href="/readbook/assets/js/15.a8ea189d.js"><link rel="prefetch" href="/readbook/assets/js/16.288634c2.js"><link rel="prefetch" href="/readbook/assets/js/17.097f1891.js"><link rel="prefetch" href="/readbook/assets/js/18.45ae2ea1.js"><link rel="prefetch" href="/readbook/assets/js/20.6000349f.js"><link rel="prefetch" href="/readbook/assets/js/21.8853e1e1.js"><link rel="prefetch" href="/readbook/assets/js/22.90d3a464.js"><link rel="prefetch" href="/readbook/assets/js/23.fabe9af3.js"><link rel="prefetch" href="/readbook/assets/js/24.af897bcf.js"><link rel="prefetch" href="/readbook/assets/js/25.bc2baf43.js"><link rel="prefetch" href="/readbook/assets/js/26.ec5f48b3.js"><link rel="prefetch" href="/readbook/assets/js/27.284db135.js"><link rel="prefetch" href="/readbook/assets/js/28.8da8020e.js"><link rel="prefetch" href="/readbook/assets/js/29.642ed6af.js"><link rel="prefetch" href="/readbook/assets/js/3.516fd641.js"><link rel="prefetch" href="/readbook/assets/js/30.c42dcde0.js"><link rel="prefetch" href="/readbook/assets/js/31.5bf0ad56.js"><link rel="prefetch" href="/readbook/assets/js/32.28c4b9fc.js"><link rel="prefetch" href="/readbook/assets/js/33.8ba11b1c.js"><link rel="prefetch" href="/readbook/assets/js/34.f1f06cae.js"><link rel="prefetch" href="/readbook/assets/js/4.bb3de599.js"><link rel="prefetch" href="/readbook/assets/js/5.f324cf32.js"><link rel="prefetch" href="/readbook/assets/js/6.713fbf29.js"><link rel="prefetch" href="/readbook/assets/js/7.ea44b13f.js"><link rel="prefetch" href="/readbook/assets/js/8.19cb361c.js"><link rel="prefetch" href="/readbook/assets/js/9.12521701.js">
    <link rel="stylesheet" href="/readbook/assets/css/0.styles.d6f0e1c6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/readbook/" class="home-link router-link-active"><!----> <span class="site-name">Ant Design 1111</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/readbook/intro.html" class="sidebar-link">å‰è¨€</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¬¬ä¸€ç« : åŸºç¡€çŸ¥è¯†</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/sc1lvc.html" class="sidebar-link">å‰ç«¯å¼€å‘çš„æ¼”å˜</a></li><li><a href="/readbook/wybhm9.html" class="sidebar-link">åˆå§‹åŒ–é¡¹ç›®</a></li><li><a href="/readbook/fd5af7.html" class="sidebar-link">ç¬¬ä¸€ä¸ªç»„ä»¶</a></li><li><a href="/readbook/agmsgo.html" class="sidebar-link">ä½¿ç”¨ Ant Design ç»„ä»¶</a></li><li><a href="/readbook/goozth.html" class="sidebar-link">å—æ§ç»„ä»¶ä¸éå—æ§ç»„ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/readbook/chapter2.html" class="sidebar-heading clickable"><span>ç¬¬äºŒç« : å¸ƒå±€ä¸è·¯ç”±</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/layout.html" class="sidebar-link">åŸºæœ¬å¸ƒå±€</a></li><li><a href="/readbook/ghalng.html" class="sidebar-link">ä¾§è¾¹å¯¼èˆª</a></li><li><a href="/readbook/ipsba8.html" class="sidebar-link">è·¯ç”±é…ç½®</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/readbook/chapter3.html" class="sidebar-heading clickable open"><span>ç¬¬ä¸‰ç« : å°è¯•ç‰›åˆ€</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/abl3ad.html" class="sidebar-link">ä½¿ç”¨ model</a></li><li><a href="/readbook/dsl8ee.html" class="active sidebar-link">æ­å»ºåŸºäº model çš„å¡ç‰‡åˆ—è¡¨é¡µé¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/readbook/dsl8ee.html#æœ€ç®€å•çš„å¡ç‰‡åˆ—è¡¨é¡µ" class="sidebar-link">æœ€ç®€å•çš„å¡ç‰‡åˆ—è¡¨é¡µ</a></li><li class="sidebar-sub-header"><a href="/readbook/dsl8ee.html#æ·»åŠ å¡ç‰‡-æŒ‰é’®" class="sidebar-link">&quot;æ·»åŠ å¡ç‰‡&quot; æŒ‰é’®</a></li><li class="sidebar-sub-header"><a href="/readbook/dsl8ee.html#åŸºäº-dva-çš„ç®€å•å¡ç‰‡åˆ—è¡¨é¡µï¼šä½¿ç”¨-connect-å¯¹æ¥é™æ€çš„-dva-model" class="sidebar-link">åŸºäº dva çš„ç®€å•å¡ç‰‡åˆ—è¡¨é¡µï¼šä½¿ç”¨ connect å¯¹æ¥é™æ€çš„ dva model</a></li><li class="sidebar-sub-header"><a href="/readbook/dsl8ee.html#æ·»åŠ å¡ç‰‡-æŒ‰é’®ï¼šä½¿ç”¨-dispatch-å’Œ-reducer-æ”¹å˜-dva-model" class="sidebar-link">&quot;æ·»åŠ å¡ç‰‡&quot; æŒ‰é’®ï¼šä½¿ç”¨ dispatch å’Œ reducer æ”¹å˜ dva model</a></li></ul></li><li><a href="/readbook/ig6mzb.html" class="sidebar-link">åœ¨ model ä¸­è¯·æ±‚æœåŠ¡ç«¯æ•°æ®</a></li><li><a href="/readbook/kmmq56.html" class="sidebar-link">æ¨¡æ‹ŸæœåŠ¡ç«¯æ•°æ®</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/readbook/chapter4.html" class="sidebar-heading clickable"><span>ç¬¬å››ç« : å¤æ‚é¡µé¢</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/ndfx96.html" class="sidebar-link">è¡¨æ ¼</a></li><li><a href="/readbook/up1dn3.html" class="sidebar-link">è¡¨å•</a></li><li><a href="/readbook/dk8xsp.html" class="sidebar-link">å›¾è¡¨</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¬¬äº”ç« : è¿›é˜¶åŠŸèƒ½</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/customized_styles.html" class="sidebar-link">è‡ªå®šä¹‰æ ·å¼</a></li><li><a href="/readbook/wvbsue.html" class="sidebar-link">ä¸Šä¼ ä¸ä¸‹è½½</a></li><li><a href="/readbook/aut0sr.html" class="sidebar-link">å›½é™…åŒ–</a></li><li><a href="/readbook/lifemethods.html" class="sidebar-link">React çš„ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="/readbook/auth.html" class="sidebar-link">æƒé™</a></li><li><a href="/readbook/unittest.html" class="sidebar-link">å•å…ƒæµ‹è¯•</a></li><li><a href="/readbook/typescript.html" class="sidebar-link">ä½¿ç”¨ TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>é™„å½•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/byllph.html" class="sidebar-link">ä½ éœ€è¦äº†è§£çš„ ES6 è¯­æ³•</a></li><li><a href="/readbook/tydf0a.html" class="sidebar-link">æ·±å…¥ç†è§£ umi</a></li><li><a href="/readbook/about.html" class="sidebar-link">å…³äºæˆ‘ä»¬</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="æ­å»ºåŸºäº-model-çš„å¡ç‰‡åˆ—è¡¨é¡µé¢"><a href="#æ­å»ºåŸºäº-model-çš„å¡ç‰‡åˆ—è¡¨é¡µé¢" aria-hidden="true" class="header-anchor">#</a> æ­å»ºåŸºäº model çš„å¡ç‰‡åˆ—è¡¨é¡µé¢</h1> <p>æœ¬ç« èŠ‚ä¸­æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªå¡ç‰‡åˆ—è¡¨é¡µï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªæŒ‰é’®å¯ä»¥æ·»åŠ æ–°å¡ç‰‡ã€‚å®Œæ•´çš„ demo ä»£ç è¯·è®¿é—® <a href="https://github.com/ant-design/react-tutorial" target="_blank" rel="noopener noreferrer">https://github.com/ant-design/react-tutorial<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ã€‚</p> <h2 id="æœ€ç®€å•çš„å¡ç‰‡åˆ—è¡¨é¡µ"><a href="#æœ€ç®€å•çš„å¡ç‰‡åˆ—è¡¨é¡µ" aria-hidden="true" class="header-anchor">#</a> æœ€ç®€å•çš„å¡ç‰‡åˆ—è¡¨é¡µ</h2> <p>æˆ‘ä»¬å…ˆæ˜¾ç¤ºä¸€ä¸ªæœ€ç®€å•çš„å¡ç‰‡åˆ—è¡¨é¡µï¼Œåªæœ‰å¡ç‰‡ï¼Œä¸åšæ·»åŠ æ“ä½œã€‚<code>src/page</code> ç›®å½•ä¸‹å»ºç«‹é¡µé¢æ–‡ä»¶ <code>puzzlecards.js</code>ï¼Œå¹¶æŠŠå®ƒåŠ å…¥åˆ°è·¯ç”±ã€‚</p> <p>é¦–å…ˆï¼Œå»ºç«‹é¡µé¢æ–‡ä»¶ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Card <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">PuzzleCardsPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      cardList<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          setup<span class="token punctuation">:</span> <span class="token string">'Did you hear about the two silk worms in a race?'</span><span class="token punctuation">,</span>
          punchline<span class="token punctuation">:</span> <span class="token string">'It ended in a tie'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          setup<span class="token punctuation">:</span> <span class="token string">'What happens to a frog\'s car when it breaks down?'</span><span class="token punctuation">,</span>
          punchline<span class="token punctuation">:</span> <span class="token string">'It gets toad away'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>cardList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>card <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Card</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Q: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>setup<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">A: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>punchline<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Card</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶æ¬¡ï¼Œé…ç½®æ–‡ä»¶ <code>config/config.js</code> å†…å¢åŠ ä¸€æ¡è·¯ç”±è§„åˆ™ã€‚</p> <div class="language-diff extra-class"><pre class="language-diff"><code>export default {


  routes: [
    {
      path: '/',
      component: '../layout',
      routes: [

<span class="token inserted">+       { path: 'puzzlecards', component: './puzzlecards' },</span>

      ]
    }
  ],


};
</code></pre></div><p>å¯åŠ¨åº”ç”¨ï¼Œçœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼š</p> <p><img src="https://cdn.nlark.com/lark/0/2018/png/58329/1533188095619-1cc50bcd-f19f-4464-b068-2d5d970b8164.png" alt="image.png | left | 747x351"></p> <h2 id="æ·»åŠ å¡ç‰‡-æŒ‰é’®"><a href="#æ·»åŠ å¡ç‰‡-æŒ‰é’®" aria-hidden="true" class="header-anchor">#</a> &quot;æ·»åŠ å¡ç‰‡&quot; æŒ‰é’®</h2> <p>åœ¨ä¸Šæ–‡çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œå¹¶åœ¨ä¸Šé¢ç»‘å®šä¸€ä¸ªå¤„ç†ç‚¹å‡»äº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚æ€è·¯æ˜¯åœ¨å›è°ƒå‡½æ•°ä¸­å‘ cardList ä¸­æ·»åŠ ä¸€ä¸ªæ–°å¡ç‰‡æ•°æ®ã€‚</p> <p>æœ€ç»ˆæˆ‘ä»¬çš„é¡µé¢æ–‡ä»¶å˜æˆå¦‚ä¸‹æ ·å­ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Card<span class="token punctuation">,</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">PuzzleCardsPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>counter <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      cardList<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          setup<span class="token punctuation">:</span> <span class="token string">'Did you hear about the two silk worms in a race?'</span><span class="token punctuation">,</span>
          punchline<span class="token punctuation">:</span> <span class="token string">'It ended in a tie'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          setup<span class="token punctuation">:</span> <span class="token string">'What happens to a frog\'s car when it breaks down?'</span><span class="token punctuation">,</span>
          punchline<span class="token punctuation">:</span> <span class="token string">'It gets toad away'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">addNewCard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>prevState <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> prevCardList <span class="token operator">=</span> prevState<span class="token punctuation">.</span>cardList<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> card <span class="token operator">=</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>counter<span class="token punctuation">,</span>
        setup<span class="token punctuation">:</span> <span class="token string">'Lorem ipsum dolor sit amet, consectetur adipiscing elit,'</span><span class="token punctuation">,</span>
        punchline<span class="token punctuation">:</span> <span class="token string">'sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        cardList<span class="token punctuation">:</span> prevCardList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>cardList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>card <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Card</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Q: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>setup<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">A: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>punchline<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Card</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addNewCard<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> æ·»åŠ å¡ç‰‡ </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è™½ç„¶æ¯æ¬¡æ·»åŠ çš„å¡ç‰‡å†…å®¹éƒ½ç›¸åŒï¼Œä½†æ˜¯ä¸è¦ç´§ï¼Œè¿™é‡Œåªæ˜¯æ¼”ç¤ºç”¨æ³•ï¼Œä½†æ˜¯æ³¨æ„å”¯ç‹¬ id ä¸èƒ½ç›¸åŒã€‚ä¸ºäº†äº§ç”Ÿå”¯ä¸€çš„ idï¼Œæˆ‘ä»¬åœ¨ç»„ä»¶ä¸­æ–°åŠ äº†ä¸€ä¸ª counter æˆå‘˜ï¼Œå®ƒåªæ˜¯ä¸ºäº†äº§ç”Ÿå”¯ä¸€ idï¼Œå¹¶ä¸æ˜¯çœŸçš„ä¸ºäº†è®¡æ•°ï¼Œæ‰€ä»¥åˆå§‹å€¼ä¸é‡è¦ï¼ˆæˆ‘ä»¬è¿™é‡Œç»™äº† 100ï¼‰ã€‚</p> <p>æ–°çš„é¡µé¢å¦‚ä¸‹ï¼š</p> <p><img src="https://cdn.nlark.com/lark/0/2018/png/58329/1533190234525-789d67b9-296f-4682-bfa1-4be9e1058a49.png" alt="image.png | left | 747x604"></p> <p><strong>åˆ°è¿™é‡Œæˆ‘ä»¬å…¶å®å·²ç»å®Œæˆäº†æƒ³è¦çš„é¡µé¢ï¼Œä¹Ÿå¹¶æ²¡æœ‰ç”¨ dvaï¼Œé‚£ dva åˆ°åº•æœ‰ä»€ä¹ˆç”¨ ï¼Ÿ</strong></p> <p>è¿™é‡Œé™ˆè¿°å‡ ä¸ªéœ€æ±‚ï¼š</p> <ul><li>åœ¨å®é™…çš„å‰ç«¯å¼€å‘ä¸­ï¼Œåƒ cardList ä¸­åŒ…å«çš„é‚£äº›æ•°æ®ï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡å‘èµ·å¼‚æ­¥ http è¯·æ±‚ä»åç«¯æœåŠ¡ä¸­è·å¾—ã€‚</li> <li>æˆ‘ä»¬å¸Œæœ›æŠŠæ•°æ®é€»è¾‘ï¼ˆcardList ç›¸å…³é€»è¾‘ï¼‰å’Œè§†å›¾é€»è¾‘ï¼ˆPuzzleCardsPageï¼‰åˆ†å¼€ç®¡ç†åœ¨ä¸åŒçš„æ¨¡å—ä¸­ï¼Œã€Œå…³æ³¨åˆ†ç¦»ã€ä½¿å¾—ä»£ç æ›´åŠ å¥å£®ï¼ŒåŒæ—¶æ˜“äºè°ƒè¯•ã€‚</li> <li>æˆ‘ä»¬å¸Œæœ›è¿™äº›æ•°æ®åœ¨éœ€è¦çš„æ—¶å€™ï¼Œå¯ä»¥æä¾›ç»™ä¸åŒçš„ç»„ä»¶ä½¿ç”¨ï¼šä¹Ÿå³æ•°æ®å…±äº«ã€‚</li></ul> <p>è€Œ dva å°±æ˜¯ç”¨æ¥æ»¡è¶³è¿™äº›éœ€æ±‚çš„ï¼š</p> <ul><li>é€šè¿‡æŠŠçŠ¶æ€ä¸Šæåˆ° dva model ä¸­ï¼Œæˆ‘ä»¬æŠŠæ•°æ®é€»è¾‘ä»é¡µé¢ä¸­æŠ½ç¦»å‡ºæ¥ã€‚</li> <li>é€šè¿‡ effect ä¼˜é›…åœ°å¤„ç†æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­çš„å‰¯ä½œç”¨ï¼Œå‰¯ä½œç”¨ä¸­æœ€å¸¸è§çš„å°±æ˜¯å¼‚æ­¥é€»è¾‘ã€‚</li> <li>dva model ä¸­çš„æ•°æ®å¯ä»¥æ³¨å…¥ç»™ä»»æ„ç»„ä»¶ã€‚</li> <li>å¦å¤–ï¼Œdva å…è®¸æŠŠæ•°æ®é€»è¾‘å†æ‹†åˆ†ï¼ˆã€Œé¡µé¢ã€å¸¸å¸¸å°±æ˜¯åˆ†éš”çš„æ ‡å¿—ï¼‰ï¼Œä»¥ namespace åŒºåˆ†ã€‚å½“ä½ è§‰å¾—æœ‰å¿…è¦æ—¶ï¼Œä¸åŒçš„ namespace ä¹‹é—´çš„ state æ˜¯å¯ä»¥äº’ç›¸è®¿é—®çš„ã€‚</li></ul> <blockquote><p>å¦‚æœä½ ç†Ÿæ‚‰ React ä¸­æœ€åŸºæœ¬çš„ä¸¤ä¸ªæ¦‚å¿µ props å’Œ stateï¼Œä¸€å®šçŸ¥é“ props å’Œ state å¯¹äºä¸€ä¸ªç»„ä»¶æ¥è®²éƒ½æ˜¯æ•°æ®çš„æ¥æºï¼Œè€Œ state åˆå¯ä»¥é€šè¿‡ props ä¼ é€’ç»™å­ç»„ä»¶ï¼Œè¿™åƒæ˜¯ä¸€ä¸ªé¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„é—®é¢˜ï¼šåˆ°åº•è°æ˜¯æ•°æ®çš„æºå¤´ ï¼Ÿç­”æ¡ˆæ˜¯ stateï¼Œè€Œä¸”æ˜¯å¹¿ä¹‰çš„ stateï¼šå®ƒå¯ä»¥æ˜¯ react ç»„ä»¶æ ‘ä¸­å„çº§ç»„ä»¶çš„ stateï¼Œä¹Ÿå¯ä»¥æ˜¯ react ç»„ä»¶æ ‘å¤–éƒ¨ç”±å…¶ä»– js æ•°æ®ç»“æ„è¡¨ç¤ºçš„ stateï¼Œè€Œ dva ç®¡ç†çš„å°±æ˜¯<a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer"> react ç»„ä»¶æ ‘ä¹‹å¤–çš„ state: Redux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚å½’æ ¹ç»“åº•ï¼Œprops æ˜¯ç”¨æ¥ä¼ å¯¼æ•°æ®çš„ï¼Œè€Œ state æ˜¯æ•°æ®æ”¹å˜çš„æºæ³‰ã€‚</p></blockquote> <h2 id="åŸºäº-dva-çš„ç®€å•å¡ç‰‡åˆ—è¡¨é¡µï¼šä½¿ç”¨-connect-å¯¹æ¥é™æ€çš„-dva-model"><a href="#åŸºäº-dva-çš„ç®€å•å¡ç‰‡åˆ—è¡¨é¡µï¼šä½¿ç”¨-connect-å¯¹æ¥é™æ€çš„-dva-model" aria-hidden="true" class="header-anchor">#</a> åŸºäº dva çš„ç®€å•å¡ç‰‡åˆ—è¡¨é¡µï¼šä½¿ç”¨ connect å¯¹æ¥é™æ€çš„ dva model</h2> <p>å¦‚æœä½ å·²ç»å¯¹ React å¼€å‘æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå°±ä¼šçŸ¥é“å­ç»„ä»¶çš„ state å¯ä»¥ä¸Šæ (state hoisting)ï¼Œç”±çˆ¶ç»„ä»¶æ¥ç®¡ç†ï¼š</p> <ul><li>å­ç»„ä»¶é—´æ¥å›è°ƒåˆ°çˆ¶ç»„ä»¶çš„ setState çš„æ–¹æ³•æ¥æ”¹å˜çˆ¶ç»„ä»¶çš„ stateï¼›</li> <li>æ–°çš„ state é€šè¿‡ props çš„å½¢å¼æŠŠå†æ¬¡è¢«å­ç»„ä»¶è·æ‚‰ã€‚</li></ul> <p>è€Œ dva å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠ state ä¸Šæåˆ° <strong>æ‰€æœ‰ React ç»„ä»¶ä¹‹ä¸Š</strong>ï¼Œè¿‡ç¨‹æ˜¯ç›¸ä¼¼çš„ï¼š</p> <ul><li>é¡µé¢é€šè¿‡è°ƒç”¨ dispatch å‡½æ•°æ¥é©±åŠ¨ dva model state çš„æ”¹å˜ï¼›</li> <li>æ”¹å˜åçš„ dva model stateé€šè¿‡ connect æ–¹æ³•æ³¨å…¥é¡µé¢ã€‚</li></ul> <p>æ‰€è°“ã€Œæ³¨å…¥ã€ä»æœ¬è´¨ä¸Šæ˜¯ <strong>æ§åˆ¶åè½¬</strong> çš„ä¸€ç§å®ç°ï¼Œè¿™ç§æ€æƒ³åœ¨è®¸å¤šçš„è¯­è¨€æ¡†æ¶ä¸­éƒ½æœ‰ä½“ç°ï¼Œæœ€è‘—åçš„è«è¿‡äºåŸºäº Java è¯­è¨€çš„ Springã€‚ç»„ä»¶ä¸å†è´Ÿè´£ç®¡ç†æ•°æ®ï¼Œç»„ä»¶åªæ˜¯é€šè¿‡ connect å‘ dva å£°æ˜æ‰€éœ€æ•°æ®ã€‚</p> <p>æœ¬èŠ‚ä¸­æˆ‘ä»¬åªåšçŠ¶æ€ä¸Šæï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªåŸºæœ¬çš„ dva model å’Œä½¿ç”¨ connectã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ <code>src/model</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª dva model æ–‡ä»¶ï¼š<code>puzzlecards.js</code>ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespace<span class="token punctuation">:</span> <span class="token string">'puzzlecards'</span><span class="token punctuation">,</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      setup<span class="token punctuation">:</span> <span class="token string">'Did you hear about the two silk worms in a race?'</span><span class="token punctuation">,</span>
      punchline<span class="token punctuation">:</span> <span class="token string">'It ended in a tie'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      setup<span class="token punctuation">:</span> <span class="token string">'What happens to a frog\'s car when it breaks down?'</span><span class="token punctuation">,</span>
      punchline<span class="token punctuation">:</span> <span class="token string">'It gets toad away'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>å…¶æ¬¡ï¼Œä¿®æ”¹ä¹‹å‰çš„é¡µé¢æ–‡ä»¶ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Card <span class="token comment">/* ,Button */</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> namespace <span class="token operator">=</span> <span class="token string">'puzzlecards'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cardList <span class="token operator">=</span> state<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    cardList<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

@<span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">PuzzleCardsPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>cardList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>card <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Card</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Q: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>setup<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">A: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>punchline<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Card</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* &lt;div&gt;
          &lt;Button onClick={this.addNewCard}&gt; æ·»åŠ å¡ç‰‡ &lt;/Button&gt;
        &lt;/div&gt; */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é¦–å…ˆï¼Œæ³¨æ„ dva model çš„å®šä¹‰ã€‚ä¸€ä¸ªåŸºæœ¬çš„ dva model æœ€å°‘å…·å¤‡ä¸¤ä¸ªæˆå‘˜ï¼šnamespace å’Œ stateã€‚namespace æ¥ä½œä¸ºä¸€ä¸ª model çš„å”¯ä¸€æ ‡è¯†ï¼Œstate ä¸­å°±æ˜¯è¯¥ model ç®¡ç†çš„æ•°æ®ã€‚</p> <p>å…¶æ¬¡ï¼Œçœ‹é¡µé¢æ–‡ä»¶çš„å˜åŒ–ï¼šæˆ‘ä»¬åˆ é™¤äº†ç»„ä»¶æœ¬èº«çš„ stateï¼ŒåŒæ—¶æ·»åŠ äº† <code>@connect(mapStateToProps)</code>ã€‚<strong>connect æ˜¯è¿æ¥ dva å’Œ React ä¸¤ä¸ªå¹³è¡Œä¸–ç•Œçš„å…³é”®ï¼Œä¸€å®šè¦ç†è§£ã€‚</strong></p> <ul><li>connect è®©ç»„ä»¶è·å–åˆ°ä¸¤æ ·ä¸œè¥¿ï¼š1. model ä¸­çš„æ•°æ®ï¼›2. é©±åŠ¨ model æ”¹å˜çš„æ–¹æ³•ã€‚</li> <li>connect æœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ª javascript å‡½æ•°ï¼Œé€šè¿‡ <code>@</code> è£…é¥°å™¨è¯­æ³•ä½¿ç”¨ï¼Œæ”¾ç½®åœ¨ç»„ä»¶å®šä¹‰çš„ä¸Šæ–¹ï¼›</li> <li>connect æ—¢ç„¶æ˜¯å‡½æ•°ï¼Œå°±å¯ä»¥æ¥å—å…¥å‚ï¼Œç¬¬ä¸€ä¸ªå…¥å‚æ˜¯æœ€å¸¸ç”¨çš„ï¼Œå®ƒéœ€è¦æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä¹ æƒ¯ç»™å®ƒå‘½åå«åš mapStateToPropsï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æŠŠ dva model ä¸­çš„ state é€šè¿‡ç»„ä»¶çš„ props æ³¨å…¥ç»™ç»„ä»¶ã€‚é€šè¿‡å®ç°è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°±èƒ½å®ç°æŠŠ dva model çš„ state æ³¨å…¥ç»™ç»„ä»¶ã€‚</li></ul> <p>mapStateToProps è¿™ä¸ªå‡½æ•°çš„å…¥å‚ state å…¶å®æ˜¯ dva ä¸­æ‰€æœ‰ state çš„æ€»åˆã€‚å¯¹äºåˆå­¦ js çš„äººå¯èƒ½ä¼šå¾ˆç–‘æƒ‘ï¼šè¿™ä¸ªå…¥å‚æ˜¯è°ç»™ä¼ å…¥çš„å‘¢ï¼Ÿå…¶å®ä½ ä¸ç”¨å…³å¿ƒï¼Œä½ åªéœ€çŸ¥é“ dva æ¡†æ¶ä¼šé€‚æ—¶è°ƒç”¨ mapStateToPropsï¼Œå¹¶ä¼ å…¥ dva model state ä½œä¸ºå…¥å‚ï¼Œæˆ‘ä»¬å†æ¬¡æé†’ï¼šä¼ å…¥çš„ state æ˜¯ä¸ª &quot;å®Œå…¨ä½“&quot;ï¼ŒåŒ…å«äº† <strong>æ‰€æœ‰</strong> namespace ä¸‹çš„ stateï¼æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ dva model state å°±æ˜¯ä»¥ namespace ä¸º key çš„ state æˆå‘˜ã€‚æ‰€ä»¥ <code>const namespace = 'puzzlecards'</code> ä¸­çš„ <code>puzzlecards</code> å¿…é¡»å’Œ model ä¸­çš„å®šä¹‰å®Œå…¨ä¸€è‡´ã€‚dva æœŸå¾… mapStateToProps å‡½æ•°è¿”å›ä¸€ä¸ª <strong>å¯¹è±¡</strong>ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè¢« dva å¹¶å…¥åˆ° props ä¸­ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å–åˆ°æ•°æ®åï¼ŒæŠŠå®ƒæ”¹åä¸º cardList å¹¶è¿”å›ï¼ˆ æ³¨æ„è¿”å›çš„ä¸æ˜¯ cardList æœ¬èº«ï¼Œè€Œæ˜¯ä¸€ä¸ªåŒ…å«äº† cardList çš„å¯¹è±¡ï¼ ï¼‰ï¼ŒcardList å°±å¯ä»¥åœ¨å­ç»„ä»¶ä¸­é€šè¿‡ props è¢«è®¿é—®åˆ°äº†ã€‚</p> <p>æ³¨æ„ render å‡½æ•°ä¸­é€šè¿‡ <code>this.props.cardList</code> å–åˆ°äº†æ•°æ®ï¼Œæ•°æ®å·²ç»ä¸å†ç”±ç»„ä»¶è‡ªå·±ç®¡ç†ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç¬¬ä¸€æ­¥ä¸­çš„é¡µé¢æ ·å­ï¼š</p> <p><img src="https://cdn.nlark.com/lark/0/2018/png/58329/1533202164449-350a18b6-e7b7-435a-9518-11daf8ff1e9c.png" alt="image.png | left | 747x266"></p> <p>è¿™é‡Œæˆ‘ä»¬åŒæ—¶åˆ©ç”¨ Redux DevTools  å±•ç¤ºäº† Dva ä¸­ state çš„å†…å®¹ï¼Œè¯æ˜äº†æˆ‘ä»¬å®šä¹‰çš„ model ç¡®å®ç”Ÿæ•ˆäº†ã€‚å¦‚æœæƒ³æ—¶åˆ»æ´å¯Ÿ model ä¸­çš„å†…å®¹ï¼Œå¼ºçƒˆå»ºè®®å®‰è£… Redux DevTools</p> <p><img src="https://cdn.nlark.com/lark/0/2018/png/58329/1533202294228-fe24ef41-b8fc-4bf3-9ea8-3179f54ea4e8.png" alt="image.png | left | 747x323"></p> <h2 id="æ·»åŠ å¡ç‰‡-æŒ‰é’®ï¼šä½¿ç”¨-dispatch-å’Œ-reducer-æ”¹å˜-dva-model"><a href="#æ·»åŠ å¡ç‰‡-æŒ‰é’®ï¼šä½¿ç”¨-dispatch-å’Œ-reducer-æ”¹å˜-dva-model" aria-hidden="true" class="header-anchor">#</a> &quot;æ·»åŠ å¡ç‰‡&quot; æŒ‰é’®ï¼šä½¿ç”¨ dispatch å’Œ reducer æ”¹å˜ dva model</h2> <p>æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ä¸­åªæ˜¯ç§»æ¤äº† stateï¼Œä½†æ˜¯æ²¡æœ‰ç§»æ¤æŒ‰é’®å’ŒæŒ‰é’®ä¸Šçš„è¡Œä¸ºã€‚React æœ‰ä¸€ä¸ªåŸºæœ¬çš„å“²å­¦ï¼šæ•°æ®æ˜ å°„åˆ°è§†å›¾ã€‚æ— è®ºä»€ä¹ˆé€”å¾„ï¼Œæˆ‘ä»¬ç‚¹å‡»æŒ‰é’®åï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å»è§¦å‘ state çš„æ”¹å˜ï¼Œstate çš„æ”¹å˜å†æ˜ å°„å›è§†å›¾ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œçš„ç›®æ ‡å°±æ˜¯ä½¿å¾—æ¯æ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œè§¦å‘ dva model çš„ä¸­å¡ç‰‡æ•°æ®å†æ·»åŠ ä¸€æ¡ã€‚è€Œåœ¨ dva çš„è¯­å¢ƒä¸­ï¼Œæ˜¯ç»Ÿä¸€é€šè¿‡ <code>dispatch</code> å‡½æ•°æ¥åšè¿™ä»¶äº‹æƒ…ã€‚</p> <p>ä¿®æ”¹ model æ–‡ä»¶ï¼ŒåŠ å…¥ reducers éƒ¨åˆ†ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespace<span class="token punctuation">:</span> <span class="token string">'puzzlecards'</span><span class="token punctuation">,</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        setup<span class="token punctuation">:</span> <span class="token string">'Did you hear about the two silk worms in a race?'</span><span class="token punctuation">,</span>
        punchline<span class="token punctuation">:</span> <span class="token string">'It ended in a tie'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        setup<span class="token punctuation">:</span> <span class="token string">'What happens to a frog\'s car when it breaks down?'</span><span class="token punctuation">,</span>
        punchline<span class="token punctuation">:</span> <span class="token string">'It gets toad away'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    counter<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  reducers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">addNewCard</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload<span class="token punctuation">:</span> newCard <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> nextCounter <span class="token operator">=</span> state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> newCardWithId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>newCard<span class="token punctuation">,</span> id<span class="token punctuation">:</span> nextCounter <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> nextData <span class="token operator">=</span> state<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newCardWithId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">:</span> nextData<span class="token punctuation">,</span>
        counter<span class="token punctuation">:</span> nextCounter<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¿®æ”¹é¡µé¢æ–‡ä»¶ï¼Œæ³¨å…¥æ–°çš„æ–¹æ³•ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Card <span class="token punctuation">,</span>Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> namespace <span class="token operator">=</span> <span class="token string">'puzzlecards'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cardList <span class="token operator">=</span> state<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    cardList<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    onClickAdd<span class="token punctuation">:</span> <span class="token punctuation">(</span>newCard<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>namespace<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/addNewCard`</span></span><span class="token punctuation">,</span>
        payload<span class="token punctuation">:</span> newCard<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

@<span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">PuzzleCardsPage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>cardList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>card <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Card</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Q: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>setup<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">A: </span><span class="token punctuation">{</span>card<span class="token punctuation">.</span>punchline<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Card</span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onClickAdd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            setup<span class="token punctuation">:</span> <span class="token string">'Lorem ipsum dolor sit amet, consectetur adipiscing elit'</span><span class="token punctuation">,</span>
            punchline<span class="token punctuation">:</span> <span class="token string">'here we use dva'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> æ·»åŠ å¡ç‰‡ </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>äºæ˜¯å¾—åˆ°æ–°çš„é¡µé¢ï¼Œ</p> <p><img src="https://cdn.nlark.com/lark/0/2018/png/58329/1533218381481-8ff07ef9-4fc7-4a15-a51a-5264e6f83764.png" alt="withDvaReducer.png | center | 747x525"></p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬è§£é‡Šä¸€ä¸‹éƒ½å¹²äº†ä»€ä¹ˆäº‹æƒ…ã€‚</p> <h3 id="ä½¿ç”¨-mapdispatchtoprops-å’Œ-dispatch"><a href="#ä½¿ç”¨-mapdispatchtoprops-å’Œ-dispatch" aria-hidden="true" class="header-anchor">#</a> ä½¿ç”¨ mapDispatchToProps å’Œ dispatch</h3> <p>é€šè¿‡ä½¿ç”¨è¿™ä¸¤è€…ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç»„ä»¶æ³¨å…¥æ–¹æ³•ï¼Œç»„ä»¶ä½¿ç”¨è¿™äº›æ–¹æ³•èƒ½ç»™ dva model å‘ã€Œæ¶ˆæ¯ã€ã€‚<code>this.props.onClickAdd</code> å°±æ˜¯è¢«æ³¨å…¥çš„æ–¹æ³•ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onClickAdd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  setup<span class="token punctuation">:</span> <span class="token string">'Lorem ipsum dolor sit amet, consectetur adipiscing elit'</span><span class="token punctuation">,</span>
  punchline<span class="token punctuation">:</span> <span class="token string">'here we use dva'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æ³¨æ„ä¸è¦å†™æˆ</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onClickAdd</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  setup<span class="token punctuation">:</span> <span class="token string">'Lorem ipsum dolor sit amet, consectetur adipiscing elit'</span><span class="token punctuation">,</span>
  punchline<span class="token punctuation">:</span> <span class="token string">'here we use dva'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>åŒºåˆ«æ˜¯ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ª click äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œè€Œä¸‹é¢æ˜¯ç›´æ¥è°ƒç”¨å‡½æ•°</strong>ã€‚å›è°ƒå‡½æ•°åœ¨ç‚¹å‡»æ—¶è¢«è°ƒç”¨ï¼Œåˆç«‹åˆ»è°ƒç”¨ onClickAddã€‚å¦‚æœç›´æ¥å†™æˆ <code>this.props.onClickAdd({})</code>ï¼Œå°±å˜æˆ render å‡½æ•°æ‰§è¡Œåˆ°æ­¤å¤„æ—¶ç›´æ¥è°ƒç”¨ onClickAdd å‡½æ•°äº†ã€‚</p> <p>onClickAdd æ˜¯æ€ä¹ˆè¢«æ³¨å…¥çš„å‘¢ ï¼Ÿç­”æ¡ˆå°±åœ¨äºæˆ‘ä»¬ç»™ connect ä¼ å…¥äº†ç¬¬äºŒä¸ªå‡½æ•°ï¼šmapDispatchToPropsã€‚æˆ‘ä»¬ä¹ æƒ¯ç”¨è¿™ä¸ªåå­—æ˜¯å› ä¸ºå®ƒç²¾ç‚¼åœ°è¯´æ˜äº†è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ï¼šä»¥ dispatch ä¸ºå…¥å‚ï¼Œè¿”å›ä¸€ä¸ªæŒ‚ç€å‡½æ•°çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸Šçš„å‡½æ•°ä¼šè¢« dva å¹¶å…¥ propsï¼Œæ³¨å…¥ç»™ç»„ä»¶ä½¿ç”¨ã€‚</p> <p>æˆ‘ä»¬åœ¨ onClickAdd å‡½æ•°ä¸­è°ƒç”¨ dispatch æ´¾å‘äº†ä¸€ä¸ª actionï¼Œaction åŒ…å« onClickAdd ä¼ é€’è¿‡æ¥çš„å†…å®¹ <code>{ setup, punchline }</code> ä½œä¸º payloadï¼Œaction çš„ type æ˜¯ <code>puzzlecards/addNewCard</code>ã€‚<code>addNewCard</code> åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ reducer çš„åå­—ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸‹é¢ä¼šè®²åˆ°ã€‚<strong>dispatch å‡½æ•°å°±æ˜¯å’Œ dva model æ‰“äº¤é“çš„å”¯ä¸€é€”å¾„ã€‚</strong> dispatch å‡½æ•°æ¥å—ä¸€ä¸ª <strong>å¯¹è±¡</strong> ä½œä¸ºå…¥å‚ï¼Œåœ¨æ¦‚å¿µä¸Šæˆ‘ä»¬ç§°å®ƒä¸º <em>action</em>ï¼Œå”¯ä¸€å¼ºåˆ¶è¦åŒ…å«çš„æ˜¯ <code>type</code> å­—æ®µï¼Œstring ç±»å‹ï¼Œç”¨æ¥å‘Šè¯‰ dva æˆ‘ä»¬æƒ³è¦å¹²ä»€ä¹ˆã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç»™ action é™„ç€å…¶ä»–å­—æ®µï¼Œè¿™é‡Œçº¦å®šç”¨ <code>payload</code>å­—æ®µè¡¨ç¤ºé¢å¤–ä¿¡æ¯ã€‚</p> <blockquote><p>æˆ‘ä»¬æŠŠæƒ³åšçš„äº‹æƒ…é€šè¿‡ action æè¿°å‡ºæ¥ï¼Œå¹¶é€šè¿‡ dispatch å‘Šè¯‰ dva modelï¼Œè€Œå¯¹è¿™ä¸ªæ¶ˆæ¯çš„å¤„ç†å°±æ˜¯ dva çš„äº‹æƒ…äº†ã€‚å¦‚æœæ·±å…¥äº†è§£ React çš„è¯»è€…ï¼Œä¸€å®šè§‰å¾—è¿™å¥è¯ä¼¼æ›¾ç›¸è¯†ã€‚æ˜¯çš„ï¼Œdva å’Œ React å“²å­¦ä¸€è„‰ç›¸æ‰¿ï¼ŒReact ä¹Ÿæ˜¯éµå¾ªè¿™ä¸ªåŸç†å·¥ä½œçš„ï¼Œåœ¨ç»„ä»¶ä¸­æ€»è¦å†™ä¸€ä¸ª render å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯å‘ React æè¿°ä½ æƒ³è¦æ¸²æŸ“å‡ºçš„å†…å®¹ï¼Œä½œä¸ºå¼€å‘è€…ä½ å¹¶ä¸ä¼šå»ç›´æ¥æ“ä½œ DOMï¼Œè€Œ React è´Ÿè´£æŠŠ render å‡½æ•°çš„è¿”å›å€¼è½¬åŒ–æˆ DOM å…ƒç´ ï¼Œå¹¶ç”± React æœ€ç»ˆå†³å®šæ¸²æŸ“ DOM çš„æ—¶æœºå’Œæµç¨‹ï¼ˆReact æ¸²æŸ“å¼•æ“çš„æ‰§è¡Œæ˜¯ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ï¼‰ã€‚</p></blockquote> <p>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯ï¼šæ´¾å‘å‡ºçš„ action æ€æ ·è¢« dva è¯†åˆ«å¹¶æ‰§è¡Œ &quot;æ·»åŠ å¡ç‰‡&quot; çš„é€»è¾‘å‘¢ ï¼Ÿ</p> <h3 id="å®šä¹‰-reducer"><a href="#å®šä¹‰-reducer" aria-hidden="true" class="header-anchor">#</a> å®šä¹‰ reducer</h3> <p>dva model ä¸­å¯ä»¥å®šä¹‰ä¸€ä¸ªå«åš <code>reducers</code> çš„æˆå‘˜ç”¨æ¥å“åº” action å¹¶ä¿®æ”¹ stateã€‚æ¯ä¸€ä¸ª reducer éƒ½æ˜¯ä¸€ä¸ª functionï¼Œaction æ´¾å‘åï¼Œé€šè¿‡ action.type è¢«å”¯ä¸€åœ°åŒ¹é…åˆ°ï¼Œéšåæ‰§è¡Œå‡½æ•°ä½“é€»è¾‘ï¼Œè¿”å›å€¼è¢« dva ä½¿ç”¨ä½œä¸ºæ–°çš„ stateã€‚state çš„æ”¹å˜éšåä¼šè¢« connect æ³¨å…¥åˆ°ç»„ä»¶ä¸­ï¼Œè§¦å‘è§†å›¾æ”¹å˜ã€‚</p> <p>reducer çš„æ ·å­å¤§æ¦‚æ˜¯ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">someReducer</span><span class="token punctuation">(</span>state <span class="token comment">/* old state */</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... do calculation</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... build a new object as next state and return it</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>reducer åº”è¯¥æ˜¯ä¸€ä¸ª &quot;çº¯å‡½æ•°&quot;ï¼Œå®ƒçš„è¿”å›å€¼ä½œä¸ºæ–°çš„ stateã€‚dva ä¼šæ³¨å…¥æ—§çš„ state å’Œ action ä¸­çš„ payloadï¼Œæ˜¯å¦ä½¿ç”¨å®Œå…¨æ ¹æ®éœ€è¦å†³å®šï¼›è¿”å›å€¼å¿…é¡»æ˜¯ä¸€ä¸ªæ–°æ„é€ å¯¹è±¡ï¼Œç»ä¸èƒ½æŠŠæ—§ state çš„å¼•ç”¨è¿”å›ï¼</p> <blockquote><p>reducer å¹²çš„äº‹æƒ…å’Œ React ä¸­ <code>setState(prevState =&gt; { ... })</code> å¾ˆåƒï¼Œéƒ½è¦è¿”å›ä¸€ä¸ªæ–°æ„é€ çš„å¯¹è±¡ï¼Œä½†åŒºåˆ«æ˜¯ï¼šreducer çš„è¿”å›å€¼ä¼š <strong>æ•´ä¸ªå–ä»£ (Replace)</strong> è€çš„ stateï¼Œè€Œ setState ä¸­å›è°ƒå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¼š <strong>èåˆ(Merge)</strong> åˆ°è€çš„ state ä¸­å»ã€‚</p></blockquote> <p>ä¸‹å›¾æ ‡ç¤ºäº†ç”± dva é©±åŠ¨çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œ</p> <p><img src="https://gw.alipayobjects.com/zos/rmsportal/uhUMfTcXxfskqbreAXth.png" alt="reducers_data_flow.png"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/readbook/abl3ad.html" class="prev">
          ä½¿ç”¨ model
        </a></span> <span class="next"><a href="/readbook/ig6mzb.html">
          åœ¨ model ä¸­è¯·æ±‚æœåŠ¡ç«¯æ•°æ®
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/readbook/assets/js/app.205826b5.js" defer></script><script src="/readbook/assets/js/2.6adc2b3f.js" defer></script><script src="/readbook/assets/js/19.8e74b4bc.js" defer></script>
  </body>
</html>
