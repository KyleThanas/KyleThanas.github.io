<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第一个组件 | Ant Design 1111</title>
    <meta name="description" content="基于 umi 的 Ant Design 1111">
    
    
    <link rel="preload" href="/readbook/assets/css/0.styles.d6f0e1c6.css" as="style"><link rel="preload" href="/readbook/assets/js/app.205826b5.js" as="script"><link rel="preload" href="/readbook/assets/js/2.6adc2b3f.js" as="script"><link rel="preload" href="/readbook/assets/js/25.bc2baf43.js" as="script"><link rel="prefetch" href="/readbook/assets/js/10.1636d440.js"><link rel="prefetch" href="/readbook/assets/js/11.70bf2f3a.js"><link rel="prefetch" href="/readbook/assets/js/12.a107a538.js"><link rel="prefetch" href="/readbook/assets/js/13.33cb767d.js"><link rel="prefetch" href="/readbook/assets/js/14.f9871772.js"><link rel="prefetch" href="/readbook/assets/js/15.a8ea189d.js"><link rel="prefetch" href="/readbook/assets/js/16.288634c2.js"><link rel="prefetch" href="/readbook/assets/js/17.097f1891.js"><link rel="prefetch" href="/readbook/assets/js/18.45ae2ea1.js"><link rel="prefetch" href="/readbook/assets/js/19.8e74b4bc.js"><link rel="prefetch" href="/readbook/assets/js/20.6000349f.js"><link rel="prefetch" href="/readbook/assets/js/21.8853e1e1.js"><link rel="prefetch" href="/readbook/assets/js/22.90d3a464.js"><link rel="prefetch" href="/readbook/assets/js/23.fabe9af3.js"><link rel="prefetch" href="/readbook/assets/js/24.af897bcf.js"><link rel="prefetch" href="/readbook/assets/js/26.ec5f48b3.js"><link rel="prefetch" href="/readbook/assets/js/27.284db135.js"><link rel="prefetch" href="/readbook/assets/js/28.8da8020e.js"><link rel="prefetch" href="/readbook/assets/js/29.642ed6af.js"><link rel="prefetch" href="/readbook/assets/js/3.516fd641.js"><link rel="prefetch" href="/readbook/assets/js/30.c42dcde0.js"><link rel="prefetch" href="/readbook/assets/js/31.5bf0ad56.js"><link rel="prefetch" href="/readbook/assets/js/32.28c4b9fc.js"><link rel="prefetch" href="/readbook/assets/js/33.8ba11b1c.js"><link rel="prefetch" href="/readbook/assets/js/34.f1f06cae.js"><link rel="prefetch" href="/readbook/assets/js/4.bb3de599.js"><link rel="prefetch" href="/readbook/assets/js/5.f324cf32.js"><link rel="prefetch" href="/readbook/assets/js/6.713fbf29.js"><link rel="prefetch" href="/readbook/assets/js/7.ea44b13f.js"><link rel="prefetch" href="/readbook/assets/js/8.19cb361c.js"><link rel="prefetch" href="/readbook/assets/js/9.12521701.js">
    <link rel="stylesheet" href="/readbook/assets/css/0.styles.d6f0e1c6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/readbook/" class="home-link router-link-active"><!----> <span class="site-name">Ant Design 1111</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/readbook/intro.html" class="sidebar-link">前言</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>第一章: 基础知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/sc1lvc.html" class="sidebar-link">前端开发的演变</a></li><li><a href="/readbook/wybhm9.html" class="sidebar-link">初始化项目</a></li><li><a href="/readbook/fd5af7.html" class="active sidebar-link">第一个组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/readbook/fd5af7.html#组件是什么？" class="sidebar-link">组件是什么？</a></li><li class="sidebar-sub-header"><a href="/readbook/fd5af7.html#jsx-语法" class="sidebar-link">JSX 语法</a></li><li class="sidebar-sub-header"><a href="/readbook/fd5af7.html#react-组件语法" class="sidebar-link">React 组件语法</a></li><li class="sidebar-sub-header"><a href="/readbook/fd5af7.html#组件的参数" class="sidebar-link">组件的参数</a></li><li class="sidebar-sub-header"><a href="/readbook/fd5af7.html#组件的状态" class="sidebar-link">组件的状态</a></li><li class="sidebar-sub-header"><a href="/readbook/fd5af7.html#生命周期方法" class="sidebar-link">生命周期方法</a></li></ul></li><li><a href="/readbook/agmsgo.html" class="sidebar-link">使用 Ant Design 组件</a></li><li><a href="/readbook/goozth.html" class="sidebar-link">受控组件与非受控组件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/readbook/chapter2.html" class="sidebar-heading clickable"><span>第二章: 布局与路由</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/layout.html" class="sidebar-link">基本布局</a></li><li><a href="/readbook/ghalng.html" class="sidebar-link">侧边导航</a></li><li><a href="/readbook/ipsba8.html" class="sidebar-link">路由配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/readbook/chapter3.html" class="sidebar-heading clickable"><span>第三章: 小试牛刀</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/abl3ad.html" class="sidebar-link">使用 model</a></li><li><a href="/readbook/dsl8ee.html" class="sidebar-link">搭建基于 model 的卡片列表页面</a></li><li><a href="/readbook/ig6mzb.html" class="sidebar-link">在 model 中请求服务端数据</a></li><li><a href="/readbook/kmmq56.html" class="sidebar-link">模拟服务端数据</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/readbook/chapter4.html" class="sidebar-heading clickable"><span>第四章: 复杂页面</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/ndfx96.html" class="sidebar-link">表格</a></li><li><a href="/readbook/up1dn3.html" class="sidebar-link">表单</a></li><li><a href="/readbook/dk8xsp.html" class="sidebar-link">图表</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第五章: 进阶功能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/customized_styles.html" class="sidebar-link">自定义样式</a></li><li><a href="/readbook/wvbsue.html" class="sidebar-link">上传与下载</a></li><li><a href="/readbook/aut0sr.html" class="sidebar-link">国际化</a></li><li><a href="/readbook/lifemethods.html" class="sidebar-link">React 的生命周期</a></li><li><a href="/readbook/auth.html" class="sidebar-link">权限</a></li><li><a href="/readbook/unittest.html" class="sidebar-link">单元测试</a></li><li><a href="/readbook/typescript.html" class="sidebar-link">使用 TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>附录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readbook/byllph.html" class="sidebar-link">你需要了解的 ES6 语法</a></li><li><a href="/readbook/tydf0a.html" class="sidebar-link">深入理解 umi</a></li><li><a href="/readbook/about.html" class="sidebar-link">关于我们</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="第一个组件"><a href="#第一个组件" aria-hidden="true" class="header-anchor">#</a> 第一个组件</h1> <p>上一节，我们写了一个页面组件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>页面插入这个组件以后，就会显示 Hello World 。但是，上一节并没有解释这段代码的含义，只是让大家照着拷贝。</p> <p>本节就来解释什么是组件，以及怎样写组件。这是 React 和 Ant Design 的使用基础，只有学会了这些内容，才能理解后面的知识。如果你对 React 已经有所了解，可以跳过这一节。</p> <h2 id="组件是什么？"><a href="#组件是什么？" aria-hidden="true" class="header-anchor">#</a> 组件是什么？</h2> <p>按照功能划分，一张网页可以由多个互相独立的功能单位组成，这种功能单位就叫做“组件”（component）。比如，典型的网页分成页头、内容、页尾三个部分，就可以写成三个组件：Header、Content、Footer。这些组件拼装在一起，就构成了一张页面。</p> <p>组件内部还可以包含下一级的组件。比如，“文章”组件内部可以包含“表单”组件，“表单”组件内部又可以包含“按钮”组件。</p> <p>组件的好处有很多，下面是其中几点。</p> <ul><li>有利于细化 UI 逻辑，不同的组件负责不同的功能点。</li> <li>有利于代码复用，多个页面可以使用同样的组件。</li> <li>有利于人员分工，不同的工程师负责不同的组件。</li></ul> <p>React 的核心概念就是组件。这个框架的主要功能，就是定义了一套编写和使用组件的规范。本节开头的那段代码，就是定义了一个最简单的组件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码采用 ES6 模块格式，默认输出一个箭头函数。这个函数执行后，返回了一段 JSX 代码（后文介绍），代表 hello world 区块。这就是最简单的 React 组件的写法。</p> <h2 id="jsx-语法"><a href="#jsx-语法" aria-hidden="true" class="header-anchor">#</a> JSX 语法</h2> <p>第一次接触 React 的用户，都会有一个共同的疑问，为什么 JavaScript 代码里面可以直接插入 HTML 代码。这难道不会报错吗？</p> <p>回答是如果你把上面的代码，放到 JavaScript 引擎里面运行，确实会报错。因为这种语法不是 JavaScript，而是 React 为了方便开发者自创的 JSX 语法。</p> <p>JSX 可以被 Babel 转码器转为正常的 JavaScript 语法。上面的 JSX 语法转码后的结果如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
    <span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">&quot;hello world&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>两种写法一比较，就会发现对于复杂的 UI 组件来说，JSX 更易写也更易读。所以，几乎所有的 React 开发者都使用 JSX 语法。</p> <p>JSX 语法的特点就是，凡是使用 JavaScript 的值的地方，都可以插入这种类似 HTML 的语法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>这里有两个注意点。一是所有 HTML 标签必须是闭合的，如果写成<code>&lt;h1&gt;Hello</code>就会报错。如果是那种没有闭合语法的标签，必须在标签尾部加上斜杠，比如<code>&lt;img src=&quot;&quot; /&gt;</code>。二是任何 JSX 表达式，顶层只能有一个标签，也就是说只能有一个根元素。下面的写法会报错。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 报错</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>hello<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">// 不报错</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>hello<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，第一种写法会报错，因为根元素的位置有两个并列的<code>&lt;h1&gt;</code>标签。在它们外面再包一层，就不会报错了。</p> <p>一般来说，HTML 原生标签都使用小写，开发者自定义的组件标签首字母大写，比如<code>&lt;MyComponent/&gt;</code>。</p> <p>JSX 语法允许 HTML 与 JS 代码混写。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>
    Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token function">formatName</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">!</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，<code>&lt;h1&gt;</code>标签的文字内容部分嵌入了 JS 代码。每次生成的文本，取决于函数<code>formatName(user)</code>执行的结果。</p> <p>可以看到，JSX 语法的值的部分，只要使用了大括号<code>{}</code>，就表示进入 JS 的上下文，可以写入 JS 代码。</p> <p>更多介绍请参考<a href="https://reactjs.org/docs/introducing-jsx.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="react-组件语法"><a href="#react-组件语法" aria-hidden="true" class="header-anchor">#</a> React 组件语法</h2> <p>虽然输出 JSX 代码的函数就是一个 React 组件，但是这种写法只适合那些最简单的组件。更正式、更通用的组件写法，要使用 ES6 类（class）的语法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ShoppingList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;shopping-list&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Shopping List <span class="token keyword">for</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>Instagram<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>WhatsApp<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>Oculus<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ShoppingList<span class="token punctuation">;</span>
</code></pre></div><p>上面代码定义了一个 ShoppingList 组件。自定义的组件必须继承<code>React.Component</code>这个基类，然后必须有一个<code>render</code>方法，给出组件的输出。</p> <p>使用 React 组件也很简单，引入这个组件以后，就可以直接使用。假定上面的组件脚本叫做<code>shoppinglist.js</code>，那么使用它的代码如下。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'React'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ShoppingList <span class="token keyword">from</span> <span class="token string">'./shoppinglist.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Content</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>ShoppingList name<span class="token operator">=</span><span class="token string">&quot;张三&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Content<span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，我们新建了一个<code>Content</code>组件，里面使用了<code>ShoppingList</code>组件。注意，由于这个组件除了<code>name</code>参数，没有其他内容，所以可以写成<code>&lt;ShoppingList name=&quot;张三&quot;/&gt;</code>这种直接闭合的形式。否则，可以写成下面的形式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Content</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>ShoppingList name<span class="token operator">=</span><span class="token string">&quot;张三&quot;</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/* 插入的其他内容 */</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ShoppingList<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="组件的参数"><a href="#组件的参数" aria-hidden="true" class="header-anchor">#</a> 组件的参数</h2> <p>上一节的<code>&lt;ShoppingList name=&quot;张三&quot;/&gt;</code>这行代码，<code>ShoppingList</code>是组件名，<code>name=&quot;张三&quot;</code>表示这个组件的有一个<code>name</code>参数，值为<code>张三</code>。</p> <p>组件内部，所有参数都放在<code>this.props</code>属性上面。通过<code>this.props.name</code>就可以拿到传入的值（张三）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Shopping List <span class="token keyword">for</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
</code></pre></div><p>通过这种参数机制，React 组件可以接受外部消息。</p> <p><code>this.props</code>对象有一个非常特殊的参数<code>this.props.children</code>，表示当前组件“包裹”的所有内容。比如，上面代码里面的<code>Shopping List for {this.props.name}</code>，就是<code>&lt;h1&gt;</code>元素的<code>this.props.children</code>。这个属性在 React 里面有很大的作用，它意味着组件内部可以拿到，用户在组件里面放置的内容。</p> <p>我们来看一个例子。下面是一个组件，内部使用<code>props.children</code>，获取用户传入的内容。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Picture</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>src<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面就是使用时，怎么向<code>props.children</code>传入内容。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> picture <span class="token operator">=</span> <span class="token punctuation">{</span>
    src<span class="token punctuation">:</span> <span class="token string">'https://cdn.nlark.com/yuque/0/2018/jpeg/84141/1536207007004-59352a41-4ad8-409b-a416-a4f324eb6d0b.jpeg'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">'container'</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Picture src<span class="token operator">=</span><span class="token punctuation">{</span>picture<span class="token punctuation">.</span>src<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token comment">// 这里放置的内容就是 props.children</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Picture<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="组件的状态"><a href="#组件的状态" aria-hidden="true" class="header-anchor">#</a> 组件的状态</h2> <p>除了接受外部参数，组件内部也有不同的状态。React 规定，组件的内部状态记录在<code>this.state</code>这个对象上面。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>button
        className<span class="token operator">=</span><span class="token string">&quot;square&quot;</span>
        onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token string">'X'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>value<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码中，组件<code>Square</code>的构造方法<code>constructor</code>里面定义了当前状态<code>this.state</code>对象。Square 组件的这个对象只有一个<code>value</code>属性，一开始的值是<code>null</code>。</p> <p>用户点击按钮以后，<code>onClick</code>监听函数执行<code>this.setState()</code>方法。React 使用这个方法，更新<code>this.state</code>对象。这个方法有一个特点，就是每次执行以后，它会自动调用<code>render</code>方法，导致 UI 更新。UI 里面使用<code>this.state.value</code>，输出状态值。随着用户点击按钮，页面就会显示<code>X</code>。</p> <p>可以看到，这个例子里面，内部状态用来区分用户是否点击了按钮。</p> <h2 id="生命周期方法"><a href="#生命周期方法" aria-hidden="true" class="header-anchor">#</a> 生命周期方法</h2> <p>组件的运行过程中，存在不同的阶段。React 为这些阶段提供了钩子方法，允许开发者自定义每个阶段自动执行的函数。这些方法统称为生命周期方法（lifecycle methods）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>date<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>It is <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>date<span class="token punctuation">.</span><span class="token function">toLocaleTimeString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码中，<code>componentDidMount()</code>、<code>componentWillUnmount()</code>和<code>componentDidUpdate()</code>就是三个最常用的生命周期方法。其中，<code>componentDidMount()</code>会在组件挂载后自动调用，<code>componentWillUnmount()</code>会在组件卸载前自动调用，<code>componentDidUpdate()</code>会在 UI 每次更新后调用（即组件挂载成功以后，每次调用 render 方法，都会触发这个方法）。</p> <p>后面的章节结合实例，会对这几个方法有更详细的介绍。</p> <p>此外，还有三个生命周期方法，不是经常使用，这里只需要简单了解。</p> <ul><li><code>shouldComponentUpdate(nextProps, nextState)</code>：每当<code>this.props</code>或<code>this.state</code>有变化，在<code>render</code>方法执行之前，就会调用这个方法。该方法返回一个布尔值，表示是否应该继续执行<code>render</code>方法，即如果返回<code>false</code>，UI 就不会更新，默认返回<code>true</code>。组件挂载时，<code>render</code>方法的第一次执行，不会调用这个方法。</li> <li><code>static getDerivedStateFromProps(props, state)</code>：该方法在<code>render</code>方法执行之前调用，包括组件的第一次记载。它应该返回一个新的 state 对象，通常用在组件状态依赖外部输入的参数的情况。</li> <li><code>getSnapshotBeforeUpdate()</code>：该方法在每次 DOM 更新之前调用，用来收集 DOM 信息。它返回的值，将作为参数传入<code>componentDidUpdate()</code>方法。</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/readbook/wybhm9.html" class="prev">
          初始化项目
        </a></span> <span class="next"><a href="/readbook/agmsgo.html">
          使用 Ant Design 组件
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/readbook/assets/js/app.205826b5.js" defer></script><script src="/readbook/assets/js/2.6adc2b3f.js" defer></script><script src="/readbook/assets/js/25.bc2baf43.js" defer></script>
  </body>
</html>
